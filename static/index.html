<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Video Tool - YouTube Content Automation</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .progress-ring {
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }
        .dropzone {
            border: 2px dashed #cbd5e0;
            transition: all 0.3s ease;
        }
        .dropzone.dragover {
            border-color: #4299e1;
            background-color: #ebf8ff;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <i class="fas fa-video text-blue-600 text-2xl mr-3"></i>
                    <h1 class="text-xl font-bold text-gray-900">AI Video Tool</h1>
                    <a href="/static/index.html" class="ml-6 text-gray-500 hover:text-blue-600">Home</a>
                </div>
                <div class="flex items-center space-x-4">
                    <button id="api-key-btn" class="px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300">
                        <i class="fas fa-key mr-2"></i>API Key
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Tabs -->
        <div class="bg-white rounded-lg shadow-md mb-6">
            <div class="border-b border-gray-200">
                <nav class="-mb-px flex">
                    <button class="tab-btn active py-2 px-6 border-b-2 border-blue-500 font-medium text-blue-600" data-tab="ai-images">
                        <i class="fas fa-image mr-2"></i>AI Image Generator
                    </button>
                    <button class="tab-btn py-2 px-6 border-b-2 border-transparent font-medium text-gray-600 hover:text-gray-800" data-tab="broll">
                        <i class="fas fa-film mr-2"></i>B-Roll Reorganizer
                    </button>
                    <button class="tab-btn py-2 px-6 border-b-2 border-transparent font-medium text-gray-600 hover:text-gray-800" data-tab="jobs">
                        <i class="fas fa-tasks mr-2"></i>My Jobs
                    </button>
                </nav>
            </div>
        </div>

        <!-- AI Images Tab -->
        <div id="ai-images" class="tab-content active">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Upload Section -->
                <div class="lg:col-span-2 space-y-6">
                    <!-- Script Upload -->
                    <div class="bg-white rounded-lg shadow-md p-6">
                        <h3 class="text-lg font-semibold mb-4">üìÑ Upload Script</h3>
                        <div class="dropzone p-8 rounded-lg text-center" id="script-dropzone">
                            <i class="fas fa-file-alt text-4xl text-gray-400 mb-4"></i>
                            <p class="text-gray-600 mb-2">Drop your script file here or click to browse</p>
                            <p class="text-sm text-gray-500">Supports .txt and .docx files</p>
                            <input type="file" id="script-file" class="hidden" accept=".txt,.docx">
                        </div>
                        <div id="script-info" class="hidden mt-4 p-4 bg-green-50 rounded-lg">
                            <p class="text-green-800"><i class="fas fa-check-circle mr-2"></i><span id="script-filename"></span></p>
                        </div>
                    </div>

                    <!-- Voiceover Upload -->
                    <div class="bg-white rounded-lg shadow-md p-6">
                        <h3 class="text-lg font-semibold mb-4">üéôÔ∏è Upload Voiceover</h3>
                        <div class="dropzone p-8 rounded-lg text-center" id="voice-dropzone">
                            <i class="fas fa-microphone text-4xl text-gray-400 mb-4"></i>
                            <p class="text-gray-600 mb-2">Drop your voiceover file here or click to browse</p>
                            <p class="text-sm text-gray-500">Supports .mp3, .wav, .m4a files</p>
                            <input type="file" id="voice-file" class="hidden" accept=".mp3,.wav,.m4a">
                        </div>
                        <div id="voice-info" class="hidden mt-4 p-4 bg-green-50 rounded-lg">
                            <p class="text-green-800"><i class="fas fa-check-circle mr-2"></i><span id="voice-filename"></span></p>
                        </div>
                    </div>
                </div>

                <!-- Settings Section -->
                <div class="space-y-6">
                    <!-- Generation Settings -->
                    <div class="bg-white rounded-lg shadow-md p-6">
                        <h3 class="text-lg font-semibold mb-4">‚öôÔ∏è Generation Settings</h3>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Number of Images</label>
                                <input type="number" id="image-count" value="5" min="1" max="20" class="w-full px-3 py-2 border rounded-lg">
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Image Style</label>
                                <select id="image-style" class="w-full px-3 py-2 border rounded-lg">
                                    <option value="Photorealistic">Photorealistic</option>
                                    <option value="Cinematic">Cinematic</option>
                                    <option value="Anime/Manga">Anime/Manga</option>
                                    <option value="3D Render">3D Render</option>
                                    <option value="Oil Painting">Oil Painting</option>
                                    <option value="Watercolor">Watercolor</option>
                                    <option value="Comic Book">Comic Book</option>
                                    <option value="Digital Art">Digital Art</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Character Description</label>
                                <textarea id="character-desc" rows="4" class="w-full px-3 py-2 border rounded-lg" 
                                    placeholder="Describe your main character(s) in detail..."></textarea>
                            </div>

                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="checkbox" id="export-images" checked class="mr-2">
                                    <span class="text-sm">Export Still Images</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="export-clips" checked class="mr-2">
                                    <span class="text-sm">Export Video Clips</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" id="export-full-video" class="mr-2">
                                    <span class="text-sm">Create Full Video</span>
                                </label>
                            </div>
                        </div>

                        <button id="generate-btn" class="w-full mt-6 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50" disabled>
                            <i class="fas fa-magic mr-2"></i>Generate AI Images
                        </button>
                    </div>

                    <!-- Progress Section -->
                    <div id="ai-progress-section" class="bg-white rounded-lg shadow-md p-6 hidden">
                        <h3 class="text-lg font-semibold mb-4">Progress</h3>
                        <div class="relative pt-1">
                            <div class="flex mb-2 items-center justify-between">
                                <div>
                                    <span class="text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-blue-600 bg-blue-200">
                                        <span id="ai-progress-percent">0</span>%
                                    </span>
                                </div>
                            </div>
                            <div class="overflow-hidden h-2 mb-4 text-xs flex rounded bg-blue-200">
                                <div id="ai-progress-bar" style="width:0%" class="shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-blue-600 transition-all duration-500"></div>
                            </div>
                        </div>
                        <div id="ai-status" class="text-sm text-gray-600"></div>
                    </div>
                </div>
            </div>

            <!-- Preview Section -->
            <div id="ai-preview-section" class="mt-6 bg-white rounded-lg shadow-md p-6 hidden">
                <h3 class="text-lg font-semibold mb-4">üñºÔ∏è Generated Images Preview</h3>
                <div id="ai-preview-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                    <!-- Images will be added here dynamically -->
                </div>
            </div>
        </div>

        <!-- B-Roll Tab -->
        <div id="broll" class="tab-content">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Upload Section -->
                <div class="lg:col-span-2 space-y-6">
                    <!-- B-Roll Upload -->
                    <div class="bg-white rounded-lg shadow-md p-6">
                        <h3 class="text-lg font-semibold mb-4">üé• Upload B-Roll Clips</h3>
                        <div class="dropzone p-8 rounded-lg text-center" id="broll-dropzone">
                            <i class="fas fa-video text-4xl text-gray-400 mb-4"></i>
                            <p class="text-gray-600 mb-2">Drop your B-roll clips here or click to browse</p>
                            <p class="text-sm text-gray-500">Supports multiple .mp4, .avi, .mov, .mkv files</p>
                            <input type="file" id="broll-files" class="hidden" accept=".mp4,.avi,.mov,.mkv" multiple>
                        </div>
                        <div id="broll-list" class="mt-4 space-y-2"></div>
                    </div>

                    <!-- Intro Clips Upload -->
                    <div class="bg-white rounded-lg shadow-md p-6">
                        <h3 class="text-lg font-semibold mb-4">üé¨ Upload Intro Clips (Optional)</h3>
                        <div class="dropzone p-8 rounded-lg text-center" id="intro-dropzone">
                            <i class="fas fa-film text-4xl text-gray-400 mb-4"></i>
                            <p class="text-gray-600 mb-2">Drop your intro clips here or click to browse</p>
                            <p class="text-sm text-gray-500">These will play before the B-roll</p>
                            <input type="file" id="intro-files" class="hidden" accept=".mp4,.avi,.mov,.mkv" multiple>
                        </div>
                        <div id="intro-list" class="mt-4 space-y-2"></div>
                    </div>

                    <!-- Voiceover Upload -->
                    <div class="bg-white rounded-lg shadow-md p-6">
                        <h3 class="text-lg font-semibold mb-4">üéß Upload Voiceover (Optional)</h3>
                        <div class="dropzone p-8 rounded-lg text-center" id="broll-voice-dropzone">
                            <i class="fas fa-headphones text-4xl text-gray-400 mb-4"></i>
                            <p class="text-gray-600 mb-2">Drop your voiceover file here or click to browse</p>
                            <p class="text-sm text-gray-500">The video will sync to this audio</p>
                            <input type="file" id="broll-voice-file" class="hidden" accept=".mp3,.wav,.m4a">
                        </div>
                        <div id="broll-voice-info" class="hidden mt-4 p-4 bg-green-50 rounded-lg">
                            <p class="text-green-800"><i class="fas fa-check-circle mr-2"></i><span id="broll-voice-filename"></span></p>
                        </div>
                    </div>
                </div>

                <!-- Settings Section -->
                <div class="space-y-6">
                    <!-- Organization Settings -->
                    <div class="bg-white rounded-lg shadow-md p-6">
                        <h3 class="text-lg font-semibold mb-4">‚öôÔ∏è Organization Settings</h3>
                        
                        <div class="space-y-4">
                            <label class="flex items-center">
                                <input type="checkbox" id="sync-duration" checked class="mr-2">
                                <span class="text-sm">Sync video to voiceover length</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="overlay-audio" checked class="mr-2">
                                <span class="text-sm">Overlay voiceover on final video</span>
                            </label>
                        </div>

                        <button id="organize-btn" class="w-full mt-6 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50" disabled>
                            <i class="fas fa-random mr-2"></i>Reorganize B-Roll
                        </button>
                    </div>

                    <!-- Progress Section -->
                    <div id="broll-progress-section" class="bg-white rounded-lg shadow-md p-6 hidden">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold">üé¨ B-Roll Organization Progress</h3>
                            <div class="flex items-center space-x-2">
                                <span class="text-xs font-semibold inline-block py-1 px-3 uppercase rounded-full text-green-600 bg-green-200">
                                    <span id="broll-progress-percent">0</span>%
                                </span>
                            </div>
                        </div>
                        <div class="relative pt-1">
                            <div class="overflow-hidden h-3 mb-4 text-xs flex rounded-full bg-gray-200 shadow-inner">
                                <div id="broll-progress-bar" style="width:0%" class="shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-green-600 transition-all duration-700 ease-out rounded-full relative">
                                    <div class="absolute inset-0 bg-white bg-opacity-20 rounded-full"></div>
                                </div>
                            </div>
                        </div>
                        <div id="broll-status" class="text-sm text-gray-700 font-medium text-center"></div>
                        <div class="mt-4 text-xs text-gray-500 text-center">
                            <i class="fas fa-info-circle mr-1"></i>
                            Progress updates every 2 seconds
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Jobs Tab -->
        <div id="jobs" class="tab-content">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-lg font-semibold mb-4">üìã Job History</h3>
                <div id="jobs-list" class="space-y-4">
                    <!-- Jobs will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Progress Starting Modal -->
    <div id="progress-starting-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden overflow-y-auto h-full w-full z-50">
        <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
            <div class="text-center">
                <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 mb-4">
                    <i class="fas fa-spinner fa-spin text-green-600 text-2xl"></i>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Starting B-Roll Organization</h3>
                <p class="text-sm text-gray-600 mb-4">Preparing your video clips for processing...</p>
                <div class="relative pt-1 mb-4">
                    <div class="overflow-hidden h-2 text-xs flex rounded bg-green-200">
                        <div id="starting-progress-bar" style="width:0%" class="shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-green-600 transition-all duration-500"></div>
                    </div>
                </div>
                <p id="starting-status" class="text-xs text-gray-500">Initializing...</p>
            </div>
        </div>
    </div>

    <!-- API Key Modal -->
    <div id="api-key-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden overflow-y-auto h-full w-full z-50">
        <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold">Set OpenAI API Key</h3>
                <button type="button" onclick="closeModal('api-key-modal')" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="api-key-form">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">API Key</label>
                    <div class="relative">
                        <input type="password" name="api_key" id="api-key-input" required 
                               class="w-full px-3 py-2 pr-10 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                               placeholder="sk-...">
                        <button type="button" onclick="toggleApiKeyVisibility()" 
                                class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600">
                            <i id="api-key-toggle" class="fas fa-eye"></i>
                        </button>
                    </div>
                    <p class="text-xs text-gray-500 mt-1">
                        Get your API key from 
                        <a href="https://platform.openai.com/api-keys" target="_blank" class="text-blue-600 hover:underline">
                            OpenAI <i class="fas fa-external-link-alt text-xs"></i>
                        </a>
                    </p>
                </div>
                <div class="bg-blue-50 p-3 rounded-lg mb-4">
                    <p class="text-sm text-blue-800">
                        <i class="fas fa-info-circle mr-2"></i>
                        Your API key is stored locally and used only for image generation.
                    </p>
                </div>
                <div class="flex justify-end space-x-2">
                    <button type="button" class="px-4 py-2 bg-gray-300 rounded-lg hover:bg-gray-400" onclick="closeModal('api-key-modal')">Cancel</button>
                    <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                        <i class="fas fa-save mr-2"></i>Save API Key
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script src="/static/app.js"></script>
    <script>
      // Toggle API key visibility
      function toggleApiKeyVisibility() {
        const input = document.getElementById('api-key-input');
        const icon = document.getElementById('api-key-toggle');
        
        if (input.type === 'password') {
          input.type = 'text';
          icon.classList.remove('fa-eye');
          icon.classList.add('fa-eye-slash');
        } else {
          input.type = 'password';
          icon.classList.remove('fa-eye-slash');
          icon.classList.add('fa-eye');
        }
      }
      
      // Fallback tab switching logic
      document.addEventListener('DOMContentLoaded', function() {
        var tabBtns = document.querySelectorAll('.tab-btn');
        var tabContents = document.querySelectorAll('.tab-content');
        tabBtns.forEach(function(btn) {
          btn.addEventListener('click', function() {
            var tab = btn.getAttribute('data-tab');
            tabBtns.forEach(function(b) { b.classList.remove('active', 'border-blue-500', 'text-blue-600'); b.classList.add('border-transparent', 'text-gray-600'); });
            btn.classList.add('active', 'border-blue-500', 'text-blue-600'); btn.classList.remove('border-transparent', 'text-gray-600');
            tabContents.forEach(function(tc) { tc.classList.remove('active'); });
            var activeTab = document.getElementById(tab);
            if (activeTab) activeTab.classList.add('active');
          });
        });
      });
    </script>
</body>
</html>